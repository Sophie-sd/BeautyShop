class BeautyShopApp{constructor(){this.init()}init(){this.setupViewportHeight();this.initLazyLoading();this.initTooltips();this.initAlerts();this.initSearch();this.bindGlobalEvents()}setupViewportHeight(){const setVH=()=>{const vh=window.innerHeight*0.01;document.documentElement.style.setProperty('--vh',`${vh}px`)};setVH();window.addEventListener('resize',setVH);window.addEventListener('orientationchange',()=>{setTimeout(setVH,100)})}initLazyLoading(){if('IntersectionObserver'in window){const imageObserver=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;img.src=img.dataset.src;img.classList.remove('lazy');imageObserver.unobserve(img)}})});document.querySelectorAll('img[data-src]').forEach(img=>{imageObserver.observe(img)})}}initTooltips(){document.addEventListener('mouseenter',e=>{if(e.target.hasAttribute('data-tooltip')){this.showTooltip(e.target,e.target.dataset.tooltip)}});document.addEventListener('mouseleave',e=>{if(e.target.hasAttribute('data-tooltip')){this.hideTooltip()}})}showTooltip(element,text){const tooltip=BeautyShop.DOM.createElement('div',{className:'tooltip-custom',id:'tooltip'},[text]);document.body.appendChild(tooltip);const rect=element.getBoundingClientRect();tooltip.style.left=rect.left+(rect.width/2)-(tooltip.offsetWidth/2)+'px';tooltip.style.top=rect.top-tooltip.offsetHeight-10+'px';setTimeout(()=>tooltip.classList.add('visible'),10)}hideTooltip(){const tooltip=document.getElementById('tooltip');if(tooltip)tooltip.remove()}initAlerts(){document.querySelectorAll('.alert[data-auto-dismiss]').forEach(alert=>{const delay=parseInt(alert.dataset.autoDismiss)||5000;setTimeout(()=>{BeautyShop.Animations.fadeOut(alert,300);setTimeout(()=>alert.remove(),300)},delay)});document.addEventListener('click',e=>{if(e.target.matches('.alert-close')||e.target.closest('.alert-close')){const alert=e.target.closest('.alert');if(alert){BeautyShop.Animations.fadeOut(alert,300);setTimeout(()=>alert.remove(),300)}}})}initSearch(){const searchForm=document.querySelector('.search-form');const searchInput=document.querySelector('.search-input');if(!searchForm||!searchInput)return;let searchTimeout;searchInput.addEventListener('input',e=>{clearTimeout(searchTimeout);const query=e.target.value.trim();if(query.length<2){this.hideSearchSuggestions();return}searchTimeout=setTimeout(()=>{this.showSearchSuggestions(query)},300)});document.addEventListener('click',e=>{if(!e.target.closest('.search-container')){this.hideSearchSuggestions()}})}showSearchSuggestions(query){const suggestions=['Гель-лак','Манікюрні інструменти','Засоби для депіляції'].filter(item=>item.toLowerCase().includes(query.toLowerCase()));if(suggestions.length===0)return;const suggestionsDiv=BeautyShop.DOM.createElement('div',{className:'search-suggestions'});suggestions.forEach(suggestion=>{const item=BeautyShop.DOM.createElement('div',{className:'search-suggestion-item'},[suggestion]);item.addEventListener('click',()=>{document.querySelector('.search-input').value=suggestion;document.querySelector('.search-form').submit()});suggestionsDiv.appendChild(item)});const container=document.querySelector('.search-container');this.hideSearchSuggestions();container.appendChild(suggestionsDiv)}hideSearchSuggestions(){const suggestions=document.querySelector('.search-suggestions');if(suggestions)suggestions.remove()}bindGlobalEvents(){document.addEventListener('keydown',e=>{if(e.key==='Escape'){const modal=document.querySelector('.modal.show');if(modal)this.closeModal(modal)}});document.addEventListener('click',e=>{const link=e.target.closest('a[href^="#"]');if(link&&link.getAttribute('href')!=='#'){e.preventDefault();const target=document.querySelector(link.getAttribute('href'));if(target){target.scrollIntoView({behavior:'smooth',block:'start'})}}});document.addEventListener('click',e=>{const link=e.target.closest('a[href^="http"]');if(link&&!link.href.includes(window.location.hostname)){link.setAttribute('target','_blank');link.setAttribute('rel','noopener noreferrer')}})}closeModal(modal){modal.classList.remove('show');BeautyShop.Animations.fadeOut(modal,300);setTimeout(()=>{modal.style.display='none'},300)}showNotification(message,type='info'){const notification=BeautyShop.DOM.createElement('div',{className:`notification notification-${type}`},[message]);document.body.appendChild(notification);setTimeout(()=>notification.classList.add('show'),10);setTimeout(()=>{notification.classList.remove('show');setTimeout(()=>notification.remove(),300)},5000)}formatPrice(price,currency='₴'){return`${parseFloat(price).toFixed(2)} ${currency}`}debounce(func,wait){let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}}}BeautyShop.DOM.ready(()=>{window.app=new BeautyShopApp();document.documentElement.classList.add('js-enabled');document.body.classList.remove('loading');const sortSelect=document.getElementById('sortSelect');if(sortSelect){sortSelect.addEventListener('change',function(){const url=new URL(window.location);url.searchParams.set('sort',this.value);window.location.href=url.toString()})}});const globalStyles=`.tooltip-custom{position:absolute;background:var(--neutral-dark);color:white;padding:8px 12px;border-radius:4px;font-size:14px;z-index:1000;opacity:0;transition:opacity 0.3s ease;pointer-events:none}.tooltip-custom.visible{opacity:1}.tooltip-custom::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:var(--neutral-dark)}.search-suggestions{position:absolute;top:100%;left:0;right:0;background:white;border:1px solid var(--neutral-light);border-top:none;border-radius:0 0 8px 8px;box-shadow:var(--shadow-md);z-index:1000}.search-suggestion-item{padding:12px 16px;cursor:pointer;border-bottom:1px solid var(--neutral-light);transition:background-color 0.2s ease}.search-suggestion-item:hover{background-color:var(--gray-light)}.search-suggestion-item:last-child{border-bottom:none}.notification{position:fixed;top:20px;right:20px;padding:16px 20px;border-radius:8px;color:white;font-weight:500;z-index:1050;transform:translateX(100%);transition:transform 0.3s ease}.notification.show{transform:translateX(0)}.notification-info{background:var(--info)}.notification-success{background:var(--success)}.notification-warning{background:var(--warning)}.notification-error{background:var(--danger)}.lazy{opacity:0;transition:opacity 0.3s ease}.lazy.loaded{opacity:1}@media(max-width:767.98px){.notification{top:10px;right:10px;left:10px;transform:translateY(-100%)}.notification.show{transform:translateY(0)}}`;const styleSheet=document.createElement('style');styleSheet.textContent=globalStyles;document.head.appendChild(styleSheet);
