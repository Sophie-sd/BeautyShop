/**
 * Beauty Shop - iOS Safari Оптимізації
 * Специфічні стилі для iOS Safari
 */

/* iOS Safari viewport fixes */
@supports (-webkit-touch-callout: none) {
    /* Viewport height fix для iOS */
    .vh-100 {
        height: 100vh;
        height: calc(var(--vh, 1vh) * 100);
    }
    
    /* Safe area support */
    .container {
        padding-left: max(var(--spacing-md), env(safe-area-inset-left));
        padding-right: max(var(--spacing-md), env(safe-area-inset-right));
    }
    
    .header {
        padding-top: env(safe-area-inset-top);
    }
    
    .footer {
        padding-bottom: env(safe-area-inset-bottom);
    }
    
    /* Touch optimizations */
    .btn,
    .nav-link,
    .cart-link,
    .wishlist-link,
    .logo-img,
    .search-btn {
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        touch-action: manipulation;
    }
    
    /* Logo optimizations for iOS */
    .logo-img {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
    
    /* Search icon optimizations */
    .search-icon {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
    
    /* Prevent zoom on input focus */
    input,
    select,
    textarea {
        font-size: 16px;
    }
    
    /* Smooth scrolling improvements */
    .categories-slider,
    .products-slider {
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
        overscroll-behavior-x: contain;
    }
    
    .categories-slider .category-card,
    .products-slider .product-card {
        scroll-snap-align: start;
        scroll-snap-stop: normal;
    }
    
    /* Fix для sticky elements */
    .header {
        position: -webkit-sticky;
        position: sticky;
    }
    
    /* Emoji rendering fix */
    .category-emoji,
    .product-emoji,
    .cart-icon {
        font-family: "Apple Color Emoji", system-ui, sans-serif;
        font-variant-emoji: emoji;
        text-rendering: optimizeSpeed;
    }
    
    /* Touch gestures для слайдерів */
    .categories-slider,
    .products-slider {
        overscroll-behavior: contain;
        scroll-snap-type: x mandatory;
    }
    
    /* Backdrop blur support */
    @supports (backdrop-filter: blur(10px)) {
        .mobile-menu {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
    }
    
    /* Hardware acceleration */
    .slider-btn,
    .cart-icon,
    .hamburger {
        transform: translateZ(0);
        -webkit-transform: translateZ(0);
    }
    
    /* Fix для transform animations */
    .fade-in,
    .slide-in-up {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
    
    /* Prevent rubber band scrolling */
    body {
        overscroll-behavior: none;
    }
    
    /* Fix для input appearance */
    input[type="search"] {
        -webkit-appearance: none;
        appearance: none;
        border-radius: var(--border-radius-md);
    }
    
    /* Button appearance fix */
    .btn {
        -webkit-appearance: none;
        appearance: none;
        border-radius: var(--border-radius-md);
    }
    
    /* Fix для select dropdown */
    select {
        -webkit-appearance: none;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 12px center;
        background-size: 16px;
        padding-right: 40px;
    }
    
    /* Touch callout disable для non-selectable elements */
    .slider-btn,
    .hamburger,
    .nav-link,
    .btn {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
    }
    
    /* Text selection improvements */
    .category-name,
    .product-name,
    .section-title {
        -webkit-user-select: text;
        user-select: text;
    }
    
    /* Fix для CSS Grid на старих версіях Safari */
    @supports not (display: grid) {
        .categories-grid,
        .products-grid {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }
        
        .category-card,
        .product-card {
            flex: 1 1 calc(50% - var(--spacing-lg));
            max-width: calc(50% - var(--spacing-lg));
        }
    }
    
    /* Orientation change handling */
    @media (orientation: landscape) and (max-height: 500px) {
        .hero-section {
            height: auto;
            min-height: 100vh;
            min-height: calc(var(--vh, 1vh) * 100);
        }
        
        .section-padding {
            padding: var(--spacing-lg) 0;
        }
    }
}

/* Dark mode support для iOS */
@media (prefers-color-scheme: dark) {
    :root {
        --background-color: #1a1a1a;
        --text-color: #ffffff;
        --border-color: #333333;
    }
    
    @supports (-webkit-touch-callout: none) {
        .card {
            background: #2a2a2a;
            border-color: #333333;
        }
        
        .category-placeholder,
        .product-placeholder {
            background: #333333;
            color: #666666;
        }
    }
}

/* High contrast mode для accessibility */
@media (prefers-contrast: high) {
    @supports (-webkit-touch-callout: none) {
        .btn,
        .card,
        .nav-link {
            border: 2px solid currentColor;
        }
        
        .slider-btn {
            border: 3px solid currentColor;
        }
    }
}

/* Reduced motion для accessibility */
@media (prefers-reduced-motion: reduce) {
    @supports (-webkit-touch-callout: none) {
        .categories-slider,
        .products-slider {
            scroll-behavior: auto;
        }
        
        .fade-in,
        .slide-in-up,
        .slider-btn,
        .cart-icon {
            animation: none;
            transition: none;
        }
    }
}
