{% extends 'base.html' %}
{% load static %}

{% block title %}–ê–∫—Ü—ñ—ó - Beauty Shop{% endblock %}
{% block description %}–ê–∫—Ü—ñ—ó Beauty Shop –∑—ñ –∑–Ω–∏–∂–∫–∞–º–∏ –¥–æ 50%. –ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∞ –∫–æ—Å–º–µ—Ç–∏–∫–∞ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–∞ –≤–∏–≥—ñ–¥–Ω–∏–º–∏ —Ü—ñ–Ω–∞–º–∏.{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/sale-banners.css' %}">
<link rel="stylesheet" href="{% static 'css/promotions-slider.css' %}">
<link rel="stylesheet" href="{% static 'css/sale-page.css' %}">
{% endblock %}

{% block content %}
<!-- Sale Banners Slider -->
<section class="sale-banners-section">
    <div class="banner-slider-container" id="saleBannerSlider">
        <div class="banner-slides">
            <!-- Banner 1 -->
            <div class="banner-slide active">
                <div class="banner-image-wrapper">
                    <img 
                        src="{% static 'images/baner_sale1.jpg' %}" 
                        alt="–ê–∫—Ü—ñ–π–Ω–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è 1" 
                        class="banner-image"
                    >
                </div>
            </div>
            
            <!-- Banner 2 -->
            <div class="banner-slide">
                <div class="banner-image-wrapper">
                    <img 
                        src="{% static 'images/baner_sale2.jpg' %}" 
                        alt="–ê–∫—Ü—ñ–π–Ω–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è 2" 
                        class="banner-image"
                    >
                </div>
            </div>
            
            <!-- Banner 3 -->
            <div class="banner-slide">
                <div class="banner-image-wrapper">
                    <img 
                        src="{% static 'images/baner_sale3.jpg' %}" 
                        alt="–ê–∫—Ü—ñ–π–Ω–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è 3" 
                        class="banner-image"
                    >
                </div>
            </div>
        </div>
        
        <!-- Navigation Arrows -->
        <button class="banner-nav banner-nav-prev" aria-label="–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –±–∞–Ω–µ—Ä">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        <button class="banner-nav banner-nav-next" aria-label="–ù–∞—Å—Ç—É–ø–Ω–∏–π –±–∞–Ω–µ—Ä">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        
        <!-- Navigation Dots -->
        <div class="banner-dots"></div>
    </div>
</section>

<!-- Sale Products -->
<section class="products-section section-padding">
    <div class="container">
        {% if products %}
            <!-- Filters -->
            <div class="filters-section mb-4">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p class="results-count">
                            –ó–Ω–∞–π–¥–µ–Ω–æ <strong>{{ paginator.count }}</strong> –∞–∫—Ü—ñ–π–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤
                        </p>
                    </div>
                    <div class="col-md-6">
                        <div class="sort-options">
                            <select class="form-select" id="sortSelect">
                                <option value="default" {% if selected_sort == 'default' %}selected{% endif %}>–°–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–∞</option>
                                <option value="name" {% if selected_sort == 'name' %}selected{% endif %}>–ó–∞ –Ω–∞–∑–≤–æ—é</option>
                                <option value="price_low" {% if selected_sort == 'price_low' %}selected{% endif %}>–°–ø–æ—á–∞—Ç–∫—É –¥–µ—à–µ–≤—à—ñ</option>
                                <option value="price_high" {% if selected_sort == 'price_high' %}selected{% endif %}>–°–ø–æ—á–∞—Ç–∫—É –¥–æ—Ä–æ–∂—á—ñ</option>
                                <option value="discount" {% if selected_sort == 'discount' %}selected{% endif %}>–ó–∞ —Ä–æ–∑–º—ñ—Ä–æ–º –∑–Ω–∏–∂–∫–∏</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="products-grid products-grid--sale">
                {% for product in products %}
                    {% include 'includes/product_card.html' %}
                {% endfor %}
            </div>
            
            <!-- Pagination -->
            {% if is_paginated %}
                <nav class="pagination" role="navigation" aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö">
                    {% if page_obj.has_previous %}
                        <a href="?{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page=1" class="pagination__link" aria-label="–ü–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü®‚ü®</a>
                        <a href="?{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page={{ page_obj.previous_page_number }}" class="pagination__link" aria-label="–ü–æ–ø–µ—Ä–µ–¥–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü®</a>
                    {% else %}
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü®‚ü®</span>
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü®</span>
                    {% endif %}
                    
                    <span class="pagination__info" aria-live="polite">
                        –°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}
                    </span>
                    
                    {% if page_obj.has_next %}
                        <a href="?{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page={{ page_obj.next_page_number }}" class="pagination__link" aria-label="–ù–∞—Å—Ç—É–ø–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü©</a>
                        <a href="?{% if request.GET.sort %}sort={{ request.GET.sort }}&{% endif %}page={{ page_obj.paginator.num_pages }}" class="pagination__link" aria-label="–û—Å—Ç–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü©‚ü©</a>
                    {% else %}
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü©</span>
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü©‚ü©</span>
                    {% endif %}
                </nav>
            {% endif %}
        {% else %}
            <!-- Empty State -->
            <div class="empty-state text-center">
                <div class="empty-state-icon">
                    <i class="icon-sale" aria-hidden="true">üè∑Ô∏è</i>
                </div>
                <h3 class="empty-state-title">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∞–∫—Ü—ñ–π–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤</h3>
                <p class="empty-state-text">
                    –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –Ω–∞—à–∏–º–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏, —â–æ–± –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –≤–∏–≥—ñ–¥–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó!
                </p>
                <a href="{% url 'core:catalog' %}" class="btn btn-primary btn-lg">
                    –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥
                </a>
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/sale-banners.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const sortSelect = document.getElementById('sortSelect');
    if (sortSelect) {
        sortSelect.addEventListener('change', function() {
            const url = new URL(window.location.href);
            if (this.value && this.value !== 'default') {
                url.searchParams.set('sort', this.value);
            } else {
                url.searchParams.delete('sort');
            }
            url.searchParams.delete('page');
            window.location.href = url.toString();
        });
    }
});
</script>
{% endblock %}
