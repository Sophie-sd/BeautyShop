# –ü–æ—Å—ñ–±–Ω–∏–∫ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

## –ü—Ä–æ–±–ª–µ–º–∞: "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å"

–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —â–æ –ª–∏—Å—Ç –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ, –∞–ª–µ –Ω–µ –æ—Ç—Ä–∏–º—É—î –π–æ–≥–æ - **–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ –∞–∫–∞—É–Ω—Ç**.

### –ü—Ä–∏—á–∏–Ω–∞

–ü—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑ `is_active=False` —ñ —á–µ–∫–∞—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email. Django **–Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î** –ª–∏—Å—Ç–∏ –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—é –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º (—Ü–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –±–µ–∑–ø–µ–∫–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è).

### –†—ñ—à–µ–Ω–Ω—è 1: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Django Admin (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ Django Admin:
   ```
   https://beautyshop-django.onrender.com/admin/
   ```

2. –£–≤—ñ–π–¥—ñ—Ç—å —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –¥–∞–Ω—ñ –∑ `ADMIN_EMAIL` —Ç–∞ `ADMIN_PASSWORD`)

3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ —Ä–æ–∑–¥—ñ–ª—É **"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ"** (Users)

4. –ó–Ω–∞–π–¥—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ email: `prometeylabs@gmail.com`

5. **–í–∞—Ä—ñ–∞–Ω—Ç –ê: –®–≤–∏–¥–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Actions**
   - –í–∏–±–µ—Ä—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–ø–æ—Å—Ç–∞–≤—Ç–µ –≥–∞–ª–æ—á–∫—É)
   - –£ –≤–∏–ø–∞–¥–∞—é—á–æ–º—É –º–µ–Ω—é "Action" –≤–∏–±–µ—Ä—ñ—Ç—å:
     - **"–ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤"** - –ø—Ä–æ—Å—Ç–æ –∞–∫—Ç–∏–≤—É—î
     - –∞–±–æ **"–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ email"** - –∞–∫—Ç–∏–≤—É—î + –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î email
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Go"

6. **–í–∞—Ä—ñ–∞–Ω—Ç –ë: –†—É—á–Ω–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è**
   - –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   - –ó–Ω–∞–π–¥—ñ—Ç—å –ø–æ–ª–µ **"Active"** (–ê–∫—Ç–∏–≤–Ω–∏–π) 
   - –ü–æ—Å—Ç–∞–≤—Ç–µ –≥–∞–ª–æ—á–∫—É ‚úì
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Save"

### –†—ñ—à–µ–Ω–Ω—è 2: –ß–µ—Ä–µ–∑ Django Shell (–¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤)

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
python manage.py shell

# –ù–∞ Render
render shell -s beautyshop-django
```

```python
from apps.users.models import CustomUser

# –ó–Ω–∞–π—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
user = CustomUser.objects.get(email='prometeylabs@gmail.com')

# –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏
user.is_active = True
user.email_verified = True
user.save()

print(f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user.email} –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!")
```

### –†—ñ—à–µ–Ω–Ω—è 3: –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ª–∏—Å—Ç –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ–≤—Ç–æ—Ä–Ω–æ

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∞–º –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ email:

```python
from apps.users.models import CustomUser
from apps.users.utils import send_verification_email
from django.test import RequestFactory

user = CustomUser.objects.get(email='prometeylabs@gmail.com')

# –°—Ç–≤–æ—Ä—é—î–º–æ mock request
factory = RequestFactory()
request = factory.get('/')
request.META['HTTP_HOST'] = 'beautyshop-django.onrender.com'
request.META['wsgi.url_scheme'] = 'https'

# –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –ª–∏—Å—Ç
if send_verification_email(user, request):
    print("‚úÖ –õ–∏—Å—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ!")
else:
    print("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏")
```

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### –í Django Admin
–°–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–æ–∫–∞–∑—É—î –∫–æ–ª–æ–Ω–∫–∏:
- **email_verified** - —á–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ email
- **is_active** - —á–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ –∞–∫–∞—É–Ω—Ç

### –í Shell
```python
from apps.users.models import CustomUser

user = CustomUser.objects.get(email='prometeylabs@gmail.com')
print(f"Email: {user.email}")
print(f"Is Active: {user.is_active}")
print(f"Email Verified: {user.email_verified}")
print(f"Username: {user.username}")
```

## –¢–∏–ø–æ–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏

### 1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –æ—Ç—Ä–∏–º–∞–≤ –ª–∏—Å—Ç –ø—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
**–ü—Ä–∏—á–∏–Ω–∏:**
- Email –ø–æ—Ç—Ä–∞–ø–∏–≤ —É —Å–ø–∞–º
- –ü—Ä–æ–±–ª–µ–º–∞ –∑ Gmail App Password
- –ü–æ–º–∏–ª–∫–∞ –≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö SMTP

**–†—ñ—à–µ–Ω–Ω—è:** –ê–∫—Ç–∏–≤—É–π—Ç–µ –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ Admin

### 2. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å –∞–ª–µ –ª–∏—Å—Ç –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å
**–ü—Ä–∏—á–∏–Ω–∞:** `is_active=False`

**–†—ñ—à–µ–Ω–Ω—è:** –ê–∫—Ç–∏–≤—É–π—Ç–µ —á–µ—Ä–µ–∑ Admin, –ø–æ—Ç—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å

### 3. –Ø–∫ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —á–∏ –ø—Ä–∞—Ü—é—î email?
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ Render:
```bash
render logs -s beautyshop-django --tail
```

–®—É–∫–∞–π—Ç–µ:
- `‚úÖ Verification email sent successfully`
- `‚ùå Failed to send verification email`
- `üìß Password reset email should be sent`

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó (–æ–ø—Ü—ñ–π–Ω–æ)

–Ø–∫—â–æ —Ö–æ—á–µ—Ç–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –±–µ–∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω—É), –∑–º—ñ–Ω—ñ—Ç—å –≤ `apps/users/forms.py`:

```python
def save(self, commit=True):
    user = super().save(commit=False)
    # ... —ñ–Ω—à–∏–π –∫–æ–¥ ...
    
    # –ó–ú–Ü–ù–ò–¢–ò –¶–ï:
    user.is_active = False  # –ù–∞ —Ü–µ:
    user.is_active = True   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è
    
    if commit:
        user.save()
    return user
```

**–£–≤–∞–≥–∞:** –¶–µ –∑–Ω–∏–∂—É—î –±–µ–∑–ø–µ–∫—É - –±—É–¥—å-—Ö—Ç–æ –∑–º–æ–∂–µ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è –∑ —á—É–∂–∏–º email!

